<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Handschrift erkennen</title>
  <style>
    canvas {
      border: 2px solid #333;
      background-color: #fff;
      touch-action: none;
    }
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    button {
      margin: 10px 5px;
      padding: 10px 15px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>

  <!-- Tesseract.js (fÃ¼r Handschrifterkennung) -->
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2"></script>
</head>
<body>

  <h1>Handschrift auf dem Zeichenfeld</h1>

  <canvas id="zeichenfeld" width="500" height="300"></canvas><br>

  <button onclick="bildSpeichern()">Bild speichern</button>
  <button onclick="ocrAnalysieren()">Text erkennen (OCR)</button>

  <p><strong>Erkannt:</strong></p>
  <pre id="ergebnis" style="background: #eee; padding: 10px; white-space: pre-wrap;"></pre>

  <script>
    // Canvas-Zeichnung
    const canvas = document.getElementById("zeichenfeld");
    const ctx = canvas.getContext("2d");
    let zeichnet = false;

    function position(evt) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: (evt.touches ? evt.touches[0].clientX : evt.clientX) - rect.left,
        y: (evt.touches ? evt.touches[0].clientY : evt.clientY) - rect.top
      };
    }

    function start(evt) {
      zeichnet = true;
      const pos = position(evt);
      ctx.beginPath();
      ctx.moveTo(pos.x, pos.y);
    }

    function draw(evt) {
      if (!zeichnet) return;
      evt.preventDefault();
      const pos = position(evt);
      ctx.lineTo(pos.x, pos.y);
      ctx.stroke();
    }

    function stop() {
      zeichnet = false;
    }

    // Event-Handling
    canvas.addEventListener("mousedown", start);
    canvas.addEventListener("mousemove", draw);
    canvas.addEventListener("mouseup", stop);
    canvas.addEventListener("mouseleave", stop);

    canvas.addEventListener("touchstart", start);
    canvas.addEventListener("touchmove", draw);
    canvas.addEventListener("touchend", stop);

    // Bild speichern (optional)
    function bildSpeichern() {
      const bild = canvas.toDataURL();
      const link = document.createElement("a");
      link.href = bild;
      link.download = "zeichnung.png";
      link.click();
    }

    // OCR-Funktion
    function ocrAnalysieren() {
      const bild = canvas.toDataURL();

      Tesseract.recognize(
        bild,
        'deu', // Sprache: Deutsch
        {
          logger: m => console.log(m)
        }
      ).then(({ data: { text } }) => {
        document.getElementById("ergebnis").innerText = text.trim();
        console.log("Erkannt:", text);
      });
    }
  </script>

</body>
</html>
